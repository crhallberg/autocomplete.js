<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="../autocomplete-lite.css"/>
    <script src="../autocomplete-lite.js"></script>
    <style>
      html { font-size: 16px; }
      body {
        max-width: 64rem;
        margin: auto;
        padding: 1rem;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
      }
      input {
        width: 100%;
        height: 1.5rem;
        line-height: inherit;
      }
      input:focus {
          border: 2px solid orange;
      }
      h2 { margin-top: 0; }
      @media (min-width: 768px) {
        .row {
            display: flex;
            width: 100%;
        }
        .col {
          flex: 0 1 100%;
          margin-right: 1rem;
          padding: 1rem;
        }
      }
    </style>
  </head>
  <body>
    <h1><a href="https://github.com/vufind-org/autocomplete.js">autocomplete.js</a> demo</h1>
    <div class="row">
      <div class="col">
        <h2>Handler w/ AJAX</h2>
        <p>Basic example</p>
        <input id="ajax" type="text" placeholder="Words search from Wordnik"/>
        <script>
const AC = new Autocomplete({ limit: 10, minInputLength: 1 });
AC(document.getElementById("ajax"), function achandler(query, callback) {
    const url = "https://api.wordnik.com/v4/words.json/search/" + query + "?api_key=809e23b70d7458731900207646903be3a474ef8a97e17dc16";
    fetch(url).then(function(response) {
        return response.json();
    }).then(function(json) {
        callback( json.searchResults.map( word => word.word ) );
    });
});
        </script>
      </div>
      <div class="col">
        <h2>Static List</h2>
        <p>Custom callback and select event</p>
        <input id="static" type="text" placeholder="List of Animals"/>
        <p id="favorite-animal"></p>
        <script>
// const AC = new Autocomplete({ limit: 10 }); // from prev example
function weightedFuzzymatch(needle, haystack) {
    // terms may be switched
    if (needle.length > haystack.length) {
        // return weightedFuzzymatch(haystack, needle);
        return 0;
    }
    const needle_l = needle.toLowerCase();
    const haystack_l = haystack.toLowerCase();
    if (needle_l === haystack_l) {
        return 1 * needle_l.length;
    }
    let weight = 0;
    let straw = 0;
    let len = needle.length;
    for (let i = 0; i < len; i++) {
        while (true) {
            if (needle_l[i] === haystack_l[straw]) {
                weight += 1 - (straw - i) * .1;
                break;
            }
            straw += 1;
            if (straw === haystack.length) {
                return weight;
            }
        }
    }
    return weight;
}
AC(document.getElementById("static"), function achandler(query, callback) {
    const animals = ['aardvark','albatross','alligator','alpaca','ant','anteater','antelope','ape','armadillo','baboon','badger','barracuda','bat','bear','bee','beetle','bison','boar','buffalo','bushbaby','bustard','butterfly','camel','capuchin','caribou','cat','caterpillar','chameleon','chamois','cheetah','chicken','chimpanzee','chinchilla','chipmunk','chough','clam','cobra','cockroach','cod','cormorant','coyote','crab','crane','crocodile','crow','curlew','deer','dinosaur','dog','dogfish','dolphin','donkey','dotterel','dove','dragon','dragonfly','duck','dugong','dunlin','eagle','echidna','eel','eland','elephant','elk','emu','falcon','ferret','finch','fish','flamingo','fly','fox','frog','gaur','gazelle','gecko','gerbil','giraffe','gnu','goat','goldfish','goose','gorilla','goshawk','grasshopper','grouse','guanaco','gull','hamster','hare','hawk','hedgehog','heron','herring','hippopotamus','hornet','horse','horsecrab','hummingbird','hyena','hyrax','ibex','ibis','iguana','impala','jackal','jaguar','jay','jellyfish','kangaroo','koala','kouprey','kudu','lapwing','lark','lemming','lemur','leopard','lion','llama','lobster','locust','loris','louse','lynx','lyrebird','magpie','mallard','manatee','marten','meerkat','mink','mole','mongoose','monkey','moose','mosquito','mouse','mule','narwhal','newt','nightingale','numbat','octopus','okapi','opossum','oryx','ostrich','otter','owl','ox','oyster','panther','parrot','partridge','peacock','peafowl','pelican','penguin','pheasant','pig','pigeon','platypus','pony','porcupine','porpoise','puffin','quagga','quail','quelea','rabbit','raccoon','ram','rat','raven','reindeer','rhea','rhinoceros','rook','ruff','salamander','salmon','sambar','sandpiper','sardine','scorpion','seahorse','seal','shark','sheep','shrew','shrimp','skink','skunk','snail','snake','spider','squid','squirrel','starling','stinkbug','stork','swan','tapir','tarsier','termite','tern','tiger','toad','trout','turkey','turtle','viper','vulture','wallaby','walrus','wasp','weasel','whale','wolf','wolverine','wombat','woodcock','woodpecker','worm','wren','yak','zebra','zorilla'];
    animals.sort((a, b) => weightedFuzzymatch(query, b) - weightedFuzzymatch(query, a));
    callback(animals.map(w => ({text: w, sub: '{ text: "' + w + '", sub: "..." }'})));
});
        </script>
      </div>
      <div class="col">
        <h2>Items with HREFs</h2>
        <p>Click to go to site</p>
        <input id="href" type="text" placeholder="Words search from Wordnik"/>
        <script>
AC(document.getElementById("href"), function achandler(query, callback) {
    const url = "https://api.wordnik.com/v4/words.json/search/" + query + "?api_key=809e23b70d7458731900207646903be3a474ef8a97e17dc16";
    fetch(url).then(function(response) {
        return response.json();
    }).then(function(json) {
        callback( json.searchResults.map( word => ({
            text: "https://www.wordnik.com/words/<b>" + word.word + "</b>",
            href: "https://www.wordnik.com/words/" + word.word
        }) ) );
    });
});
        </script>
      </div>
    </div>
  </body>
</html>
